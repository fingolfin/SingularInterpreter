ring r;

poly p = x^2+y;
ideal id = (x, y^2+y);
intvec iv = 1, 2;
intmat im[2][2] = 1, 2, 3, 4;

// betti (TODO: more testing)
intmat im_betti[2][2] = 1, 1, 0, 1;
ASSUME(0, betti(id) == im_betti);

// lead
ASSUME(0, lead(p) == x^2);
ASSUME(0, p == x^2+y); // p not mutated
ASSUME(0, lead(x^2+y^3) == y^3);
ASSUME(0, lead((x^2+1, y+y^3)) == (x^2, y^3));

ideal idlead = lead(id);
ASSUME(0, idlead[1] == x);
ASSUME(0, idlead[2] == y^2);

// rvar
ASSUME(0, rvar(p) == 0);
ASSUME(0, rvar(x) == 1);
ASSUME(0, rvar(y) == 2);
ASSUME(0, rvar(z) == 3);
ASSUME(0, rvar((x^2, y, x)) == (0, 2, 1));
ASSUME(0, rvar(id) == 0);
ASSUME(0, rvar(r) == 0);
ASSUME(0, rvar("x") == 1);
ASSUME(0, rvar("xy") == 0);
ASSUME(0, rvar((x, "y")) == (1, 2));

// transpose
intmat ivt[1][2] = 1, 2;
intmat imt[2][2] = 1, 3, 2, 4;

ASSUME(0, transpose(iv) == ivt);
ASSUME(0, transpose(im) == imt);

// primefactors
ring r0 = 0,x,lp;
list pf = primefactors(number(369));
ASSUME(0, pf == list(list(3, 41), list(2, 1), 1));
pf = primefactors(bigint(369));
ASSUME(0, pf == list(list(3, 41), list(2, 1), 1));
pf = primefactors(369);
ASSUME(0, pf == list(list(3, 41), list(2, 1), 1));
pf = primefactors(36893488147419103363);
ASSUME(0, pf == list(list(36893488147419103363), list(1), 1));
ASSUME(0, typeof(pf[1][1]) == "bigint");

// chinrem
ASSUME(0, chinrem(intvec(2,-3),intvec(7,11)) == 30);
